{% extends "layout.html" %}

{% block title %}
Portfolio
{% endblock %}

{% block main %}

<!-- Market Status -->
<div class="mb-4 text-center">
    {% if market_open %}
        <span class="badge bg-success px-3 py-2">
             Market Open (NSE)
        </span>
    {% else %}
        <span class="badge bg-danger px-3 py-2">
             Market Closed (NSE)
        </span>
    {% endif %}
</div>

<div class="table-responsive">
<table class="table table-dark table-striped align-middle">
    <thead class="text-light border-bottom border-secondary">
        <tr>
            <th class="text-start">Symbol</th>
            <th class="text-end">Shares</th>
            <th class="text-end">Current Price (₹)</th>
            <th class="text-end">Total Value (₹)</th>
        </tr>
    </thead>

    <tbody>
        {% for row in data %}
        <tr>
            <td class="text-start fw-bold">{{ row.quote }}</td>
            <td class="text-end">{{ row.total_shares }}</td>
            <td class="text-end">
                ₹{{ "%.2f"|format(row.current_price) }}
            </td>
            <td class="text-end">
                ₹{{ "%.2f"|format(row.individual_total) }}
            </td>
        </tr>
        {% endfor %}
    </tbody>

    <tfoot>
        {% if error %}
        <tr>
            <td colspan="3" class="border-0 fw-bold text-end">
                Cash
            </td>
            <td class="border-0 text-end text-warning">
                Error fetching prices
            </td>
        </tr>
        <tr>
            <td colspan="3" class="border-0 fw-bold text-end">
                TOTAL
            </td>
            <td class="border-0 fw-bold text-end text-warning">
                ₹{{ "%.2f"|format(cash) }}
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="3" class="border-0 fw-bold text-end">
                Cash
            </td>
            <td class="border-0 text-end">
                ₹{{ "%.2f"|format(cash) }}
            </td>
        </tr>
        <tr>
            <td colspan="3" class="border-0 fw-bold text-end">
                TOTAL
            </td>
            <td class="border-0 fw-bold text-end text-success">
                ₹{{ "%.2f"|format(total) }}
            </td>
        </tr>
        {% endif %}
    </tfoot>
</table>
</div>

{% endblock %}
